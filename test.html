<html>

<head>

</head>
<body>
<video id="canvas" width="640" height="480">dsadsa</video>

<script>


canvas = document.getElementById("canvas");
context = canvas.getContext("2d");
canvas.addEventListener("mousedown", mouseDown);
canvas.addEventListener("mouseup", mouseUp);

function mouseDown(e) {
    if (video) {
        video.pause();
        video = null;
        context.clearRect(0, 0, canvas.width, canvas.height);
    }
    xStart = e.offsetX;
    yStart = e.offsetY;
}

function mouseUp(e) {
    xEnd = e.offsetX;
    yEnd = e.offsetY;
    if (xStart != xEnd && yStart != yEnd) {
        video = document.createElement("video");
        video.src = "http://techslides.com/demos/sample-videos/small.mp4";
        video.addEventListener('loadeddata', function() {
            console.log("loadeddata");
            video.play();
            setTimeout(videoLoop, 1000 / 30);
        });
    }
}

function videoLoop() {
    if (video && !video.paused && !video.ended) {
        context.drawImage(video, xStart, yStart, xEnd - xStart, yEnd - yStart);
        setTimeout(videoLoop, 1000 / 30);
    }
}
            // var video;
            var webcamStream;

startWebcam()

            function startWebcam() {

                continuePrediction = true;
                if (navigator.mediaDevices.getUserMedia) {
                    navigator.mediaDevices.getUserMedia(

                            // constraints
                            {
                                video: { facingMode: "environment" },
                                audio: false
                            }).then(

                            // successCallback
                            function(localMediaStream) {
                                // video.srcObject = localMediaStream;
                                canvas.srcObject = localMediaStream;
                                webcamStream = localMediaStream;
                            })
                        .catch(
                            // errorCallback
                            function(err) {
                                console.log("The following error occured: " + err);
                            })

                } else {
                    console.log("getUserMedia not supported");
                }
            }


</script>


</body>

</html>